<!DOCTYPE html>
<html>
<head>
    <title>SK College AI Chatbot</title>

    <style>
        body {
            background: #9e9e9e;
            font-family: Arial, sans-serif;
        }

        .container {
            margin: 30px auto;
            background: #bdbdbd;
            padding: 20px;
            border-radius: 20px;
            position: relative;

           width: 520px;      /* FIXED WIDTH */

           
        }
        .logo {
            text-align: center;
        }

        .logo img {
            width: 110px;
            margin-bottom: 10px;
        }

        /* üåô Toggle Button */
        .theme-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #444;
            color: #fff;
            border: none;
            padding: 6px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 13px;
        }

        h2 {
            text-align: center;
            margin-bottom: 15px;
        }

        .blink-title {
            color: #ffffff;
            font-weight: bold;
            animation: goldGlow 2.5s infinite;
        }

        @keyframes goldGlow {
            0% { text-shadow: 0 0 2px rgba(212,175,55,0.4); }
            50% { text-shadow: 0 0 8px rgba(212,175,55,0.9); }
            100% { text-shadow: 0 0 2px rgba(212,175,55,0.4); }
        }

          .chat-box {
            background: #eeeeee;
            padding: 20px;
            min-height: 250px;   /* BASE SIZE */
            max-height: 320px;   /* LIMIT */
            overflow-y: auto;
            border-radius: 15px;

       }
        .you, .bot {
           padding: 10px 14px;
           margin: 8px 12px;   /* left & right space */
           border-radius: 18px;
           font-size: 14px;

           max-width: 75%;     /* THIS IS THE KEY */
           word-wrap: break-word;

        }

        .you {
            background: #dbeafe;
            margin-left: auto;
            text-align: right;
        }

        .bot {
            background: #e6f4ea;
        }

        /* üü¢ TYPING INDICATOR */
        .typing {
            background: #e6f4ea;
            padding: 10px 14px;
            margin: 8px;
            border-radius: 18px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 14px;
        }

        .dots span {
            width: 6px;
            height: 6px;
            background: #555;
            border-radius: 50%;
            display: inline-block;
            animation: blink 1.4s infinite both;
        }

        .dots span:nth-child(2) { animation-delay: 0.2s; }
        .dots span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes blink {
            0% { opacity: 0.2; }
            20% { opacity: 1; }
            100% { opacity: 0.2; }
        }

        .chat-controls {
            margin-top: 15px;
            text-align: center;
        }

        select {
            width: 40%;
            padding: 8px;
            border-radius: 10px;
            border: none;
            margin-bottom: 15px;
        }

        input[type="text"] {
            width: 60%;
            padding: 7px;
            border-radius: 10px;
            border: 1px solid #ccc;
            margin-bottom: 15px;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .send-btn {
            background: #4a90e2;
            color: white;
            padding: 8px 18px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
        }

        .speak-btn {
            background: #6c5ce7;
            color: white;
            padding: 8px 18px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
        }

        .clear-btn {
            background: #e74c3c;
            color: white;
            padding: 6px 14px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
        }
         .message {
             max-width: 85%;
             word-wrap: break-word;
             padding: 10px;
             border-radius: 12px;
        }
         .bot-message {
             background: #e8f5e9;
             color: #000;
        }


        /* üåë DARK MODE */
        body.dark {
            background: #121212;
        }

        body.dark .container { background: #1e1e1e; }
        body.dark .chat-box { background: #2a2a2a; }
        body.dark .you { background: #1f3a5f; color: #fff; }
        body.dark .bot,
        body.dark .typing { background: #1f4f3a; color: #fff; }
        body.dark select,
        body.dark input[type="text"] { background: #333; color: #fff; }
        body.dark .theme-toggle { background: #ddd; color: #000; }
.ai-status {
    text-align: center;
    font-size: 13px;
    color: #3b82f6;/* goldblack */
    margin-bottom: 10px;
    letter-spacing: 0.5px;
}
.quick-actions {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.quick-actions span {
    background: #e0e0e0;
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    cursor: pointer;
}
.quick-actions {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 10px 0 15px;
}

.quick-actions button {
    background: #e0e0e0;
    border: none;
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 13px;
    cursor: pointer;
}

.options-box {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.options-box button {
    background: #c7d2fe;
    border: none;
    padding: 5px 12px;
    border-radius: 16px;
    font-size: 12px;
    cursor: pointer;
}

.options-box {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin: 15px 0;
}

.option-btn {
    background: #e3f2fd;
    border: none;
    padding: 8px 14px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 13px;
}

.option-btn:hover {
    background: #bbdefb;
}

    </style>
</head>

<body>

<div class="container">

    <div class="logo">
        <img src="/static/college_logo" alt="Logo">
    </div>

    <button type="button" class="theme-toggle" id="themeBtn">üåô Dark</button>

    <h2 class="blink-title">üéì Your 24/7 Digital College Guide ü§ñ</h2>
<p class="ai-status">üü¢ AI Assistant Online ‚Ä¢ Ready to help</p>
<div class="quick-actions">
    <button onclick="showOptions('fees')">üí∞ Fees</button>
    <button onclick="showOptions('courses')">üéì Courses</button>
    <button onclick="showOptions('syllabus')">üìò Syllabus</button>
    <button onclick="showOptions('facilities')">üè´ Facilities</button>
</div>


<div id="optionsBox" class="options-box" style="display:none;"></div>


    <!-- CHAT BOX -->
    <div class="chat-box" id="chatBox">
<div class="bot">
ü§ñ Hello! I‚Äôm the official AI Assistant of SK College!!<br>
           How Can I Help You...?
</div>

        {% for sender, msg in chat_history %}
            {% if sender == "You" %}
                <div class="you">üë§ {{ msg }}</div>
            {% else %}
                <div class="bot">ü§ñ {{ msg }}</div>
            {% endif %}
        {% endfor %}

        <div id="typingIndicator" class="typing" style="display:none;">
            ü§ñ
            <div class="dots">
                <span></span><span></span><span></span>
            </div>
        </div>
    </div>

    <!-- INPUT -->
    <form method="post" class="chat-controls" onsubmit="return handleSubmit(event)">
        <select name="category">
            <option value="">All Categories</option>
            <option>Admission</option>
            <option>Fees</option>
            <option>Facilities</option>
            <option>Course</option>
            <option>Exams</option>
        </select>

        <input type="text" id="user_input" name="user_input" placeholder="Ask a question..." required>

        <div class="btn-group">
            <button type="submit" class="send-btn">Send</button>
            <button type="button" class="speak-btn" id="speakBtn">üé§ Speak</button>
        </div>
    </form>

    <!-- CLEAR -->
    <form method="post">
        <input type="hidden" name="action" value="clear">
        <button type="submit" class="clear-btn">üßπ Clear Chat</button>
    </form>

</div>

<script>
    const chatBox = document.getElementById("chatBox");
    const typingIndicator = document.getElementById("typingIndicator");

    chatBox.scrollTop = chatBox.scrollHeight;

    function handleSubmit(event) {
        event.preventDefault();
        typingIndicator.style.display = "inline-flex";
        chatBox.scrollTop = chatBox.scrollHeight;

        setTimeout(() => {
            event.target.submit();
        }, 1000);

        return false;
    }

    // üåó THEME
    const btn = document.getElementById("themeBtn");

    if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark");
        btn.textContent = "‚òÄÔ∏è Light";
    }

    btn.addEventListener("click", () => {
        document.body.classList.toggle("dark");
        if (document.body.classList.contains("dark")) {
            localStorage.setItem("theme", "dark");
            btn.textContent = "‚òÄÔ∏è Light";
        } else {
            localStorage.setItem("theme", "light");
            btn.textContent = "üåô Dark";
        }
    });
</script>
<script>
    // ---------- VOICE INPUT ----------
    const speakBtn = document.getElementById("speakBtn");

    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();

        recognition.continuous = false;
        recognition.interimResults = false;
        recognition.lang = 'en-US';

        speakBtn.addEventListener("click", () => {
            recognition.start();
        });

        recognition.onresult = function (event) {
            const transcript = event.results[0][0].transcript;
            document.getElementById("user_input").value = transcript;
            document.querySelector(".send-btn").click();
        };

        recognition.onerror = function (event) {
            alert("Voice recognition error: " + event.error);
        };
    } else {
        speakBtn.disabled = true;
        speakBtn.textContent = "üé§ Not Supported";
    }
</script>
<script>
function showOptions(type) {
    const box = document.getElementById("optionsBox");
    let options = [];

    if (type === "fees") {
        options = ["BSc IT Fees", "BCom Fees", "BA Fees"];
    }
    else if (type === "courses") {
        options = ["BSc IT", "BCom", "BA"];
    }
    else if (type === "syllabus") {
        options = ["BSc IT Syllabus", "BCom Syllabus", "BA Syllabus"];
    }
    else if (type === "facilities") {
        options = [
            "üìö Library",
            "üíª Computer Lab",
            "üèè Sports Ground",
            "üöå Transport",
            "üè• Medical Facility",
            "üì∂ Wi-Fi Campus"
        ];
    }

    box.innerHTML = "";
    options.forEach(opt => {
        box.innerHTML += `
            <button class="option-btn" onclick="sendOption('${opt}')">
                ${opt}
            </button>
        `;
    });

    box.style.display = "flex";
}
</script>
</script><script>
function sendOption(text) {
    // put option text into input box
    const input = document.getElementById("user_input");
    input.value = text.toLowerCase();


    // submit the chat form automatically
    input.closest("form").submit();
}
</script>
<script>
function sendOptionMessage(option) {
    const chatBox = document.getElementById("chatBox");

    // User bubble
    const userDiv = document.createElement("div");
    userDiv.className = "you";
    userDiv.innerHTML = "üë§ " + option;
    chatBox.appendChild(userDiv);
   // Bot response mapping
     const responses = {
         "LIBRARY": "üìö Our college library has 20,000+ books, journals, digital resources, and a quiet study environment.",
         "TRANSPORT": "üöå College provides safe transport facilities covering major routes with multiple buses.",
         "HOSTEL": "üè† Separate hostels for boys and girls with Wi-Fi, food, and 24/7 security.",

        "BSC IT FEES": "üí∞ BSc IT Fees: ‚Çπ25,000 per year (subject to change).",
        "BCOM FEES": "üí∞ BCom Fees: ‚Çπ20,000 per year.",
        "BA FEES": "üí∞ BA Fees: ‚Çπ18,000 per year.",

        "BSC IT": "üéì BSc IT is a 3-year program focused on programming, databases, and networking.",
        "BCOM": "üéì BCom focuses on accounting, finance, and business studies.",
        "BA": "üéì BA offers humanities subjects like economics, history, and political science."
      };

    // Bot bubble
    const botDiv = document.createElement("div");
    botDiv.className = "bot";
    const key = option.trim().toUpperCase();
    botDiv.innerHTML = "ü§ñ " + (responses[key] || "Please select a valid option.");

    chatBox.appendChild(botDiv);

    chatBox.scrollTop = chatBox.scrollHeight;
}
</script>


</body>
</html>
